function Ajax(){var createXMLHttpRequest=function(){try{if(window.ActiveXObject){for(var i=5;i;i--){try{if(i==2){xmlhttp_request=new ActiveXObject("Microsoft.XMLHTTP")}else{xmlhttp_request=new ActiveXObject("Msxml2.XMLHTTP."+i+".0");xmlhttp_request.setRequestHeader("Content-Type","text/xml");xmlhttp_request.setRequestHeader("Charset","utf-8")}break}catch(e){xmlhttp_request=false}}}else{if(window.XMLHttpRequest){xmlhttp_request=new XMLHttpRequest();if(xmlhttp_request.overrideMimeType){xmlhttp_request.override.MimeType("text/xml")}}}}catch(e){}return xmlhttp_request};function checkedInput(e){if(e.checked){return e.name+"="+e.value}}function filteInput(e){switch(e.type.toLowerCase()){case"submit":case"number":case"hidden":case"password":case"text":return e.name+"="+e.value;case"checkbox":case"radio":return checkedInput(e)}return false}var createQueryString=function(f){var input=f.getElementsByTagName("input");var select=f.getElementsByTagName("select");var textarea=f.getElementsByTagName("textarea");var querystring=[];for(var i=0;i<input.length;i++){if(typeof(input[i].name)=="string"&&input[i].name!=""){querystring.push(filteInput(input[i]))}}for(var i=0;i<select.length;i++){if(typeof(select[i].name)=="string"&&select[i].name!=""){querystring.push(select[i].name+"="+select[i].value)}}for(var i=0;i<textarea.length;i++){if(typeof(textarea[i].name)=="string"&&textarea[i].name!=""){querystring.push(textarea[i].name+"="+textarea[i].value)}}return querystring.join("&")};var timeout=this.timeout=20000;var timeoutTimer;var loadingAction=function(){},timeoutAction=function(){};var xmlhttp_request=createXMLHttpRequest();var xmlDoc;this.setTimeoutAction=function(action){var args=[];for(var i=1;i<arguments.length;i++){args.push(arguments[i])}timeoutAction=function(){action.apply(this,args)}};this.setLoadingAction=function(action){var args=[];for(var i=1;i<arguments.length;i++){args.push(arguments[i])}loadingAction=function(){action.apply(this,args)}};this.get=function(url,querystring,action,xml){xml=xml||false;var args=[];for(var i=4;i<arguments.length;i++){args.push(arguments[i])}xmlhttp_request.open("GET",url+"?"+querystring+"&r="+Math.random(),true);xmlhttp_request.setRequestHeader("X-Requested-With","XMLHttpRequest");xmlhttp_request.send(null);xmlhttp_request.onreadystatechange=function(){if(xmlhttp_request.readyState==4){if(xmlhttp_request.status==200){clearTimeout(timeoutTimer);var response=(xml)?xmlhttp_request.responseXML.documentElement:xmlhttp_request.responseText;xmlDoc=response;args.push(response);if(action instanceof Object){action.apply(this,args)}}else{timeoutAction()}}if(xmlhttp_request.readyState==2){loadingAction()}};timeoutTimer=setTimeout(function(){xmlhttp_request.abort();timeoutAction()},timeout)};this.post=function(url,f,action,xml){if(typeof(f)=="string"){f=$(f)[0]}xml=xml||false;var args=[];for(var i=4;i<arguments.length;i++){args.push(arguments[i])}var data=createQueryString(f);xmlhttp_request.open("post",url+"?r="+Math.random(),true);xmlhttp_request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp_request.setRequestHeader("X-Requested-With","XMLHttpRequest");xmlhttp_request.send(data);xmlhttp_request.onreadystatechange=function(){if(xmlhttp_request.status==200){if(xmlhttp_request.readyState==4){clearTimeout(timeoutTimer);var response=(xml)?xmlhttp_request.responseXML.documentElement:xmlhttp_request.responseText;xmlDoc=response;args.push(response);if(action instanceof Object){action.apply(this,args)}}else{timeoutAction()}}if(xmlhttp_request.readyState==2){loadingAction()}};timeoutTimer=setTimeout(function(){xmlhttp_request.abort();if(this.setTimeoutAction){this.setTimeoutAction()}},timeout)};this.getNode=function(nodeName,xml){xml=xml||xmlDoc;var node;if(nodeName instanceof Array){node=nodeName[0].getElementsByTagName(nodeName[1])[0].childNodes[0]}else{node=xml.getElementsByTagName(nodeName)[0].childNodes[0]}if(!node){node={nodeValue:""}}return node};this.getNodeList=function(nodeName,xml){xml=xml||xmlDoc;return xml.getElementsByTagName(nodeName)}};