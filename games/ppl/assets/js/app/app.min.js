var myGameLevel=0;var str0;var Util={formateTime:function(e){str0=e;var t=Math.floor(e/60),n=e%60;return t+"′"+n+"″"},browerKernel:function(){var e=null;return["webkit","moz","o","ms"].forEach(function(t){"undefined"!=typeof document[t+"Hidden"]&&(e=t)}),e}},Global=Global||(window.Global={});Global.lvList=[{star:["13","30"],map:[["b1","b1","b4","b4","b3","b3","b6","b6"],["b1","b1","b4","b4","b3","b3","b6"],["b6","b6","b3","b3","b1","b1","b4","b4"],["b6","b3","b3","b1","b1","b4","b4"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["10","20"],map:[[null,"b3","b3","b3","b3","b3","b3",null],[null,"b4","b4","b4","b4","b4",null],[null,null,"b6","b6","b6","b6",null,null],[null,null,null,"b6",null,null,null],[null,null,null,"b6","b6",null,null,null],[null,null,null,"b8",null,null,null],[null,null,null,"b8","b8",null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","25"],map:[[null,null,"b3",null,null,"b3",null,null],[null,null,"b3","b4","b3",null,null],[null,null,null,"b4","b6",null,null,null],[null,null,"b4","b6","b4",null,null],[null,null,null,"b6","b8",null,null,null],[null,null,"b7","b8","b7",null,null],[null,null,null,"b8","b7",null,null,null],[null,null,null,"b7",null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["10","30"],map:[[null,null,null,"b3","b3",null,null,null],[null,null,"b6","b3","b4",null,null],[null,null,"b7","b6","b4","b1",null,null],[null,"b8","b7",null,"b1","b8",null],[null,"b1","b8",null,null,"b8","b6",null],["b2","b1",null,null,null,"b6","b7"],[null,"b2",null,null,null,null,"b7",null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["3","10"],map:[[null,null,"b8","b8","b8","b8",null,null],[null,"b8","b4","b4","b4","b8",null],[null,"b8","b4","b8","b8","b4","b8",null],[null,"b8","b4","b4","b4","b8",null],[null,null,"b8","b8","b8","b8",null,null],[null,null,"b6",null,"b6",null,null],[null,null,"b6","b6","b6","b6",null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","30"],map:[[null,"b6","b6","b6","b8","b8","b8",null],["b6",null,null,null,null,null,"b8"],[null,"b6",null,null,null,null,"b8",null],["b6","b7","b3","b4","b7","b3","b8"],[null,"b3","b4","b7","b3","b4","b7",null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","30"],map:[[null,"b8","b8",null,null,"b7","b7",null],[null,"b1",null,null,null,"b3",null],[null,"b8",null,null,null,"b4",null,null],[null,"b3",null,null,null,"b8",null],[null,"b6",null,null,null,"b1",null,null],[null,"b7",null,null,null,"b3",null],[null,"b7",null,null,null,"b4",null,null],[null,"b3",null,null,null,"b6",null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","35"],map:[[null,"b2","b2",null,null,"b1","b1",null],["b4",null,null,null,null,null,"b6"],["b7","b4",null,null,null,null,"b6","b3"],["b7",null,null,null,null,null,"b3"],["b4","b7",null,null,null,null,"b3","b6"],["b4",null,null,null,null,null,"b6"],["b2","b4",null,null,null,null,"b6","b1"],["b2","b2",null,null,null,"b1","b1"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["30","43"],map:[["b3",null,null,null,null,null,null,"b3"],["b8","b3","b7","b6","b8","b3","b7"],["b6",null,null,null,null,null,null,"b6"],["b7","b6","b8","b3","b7","b6","b8"],[null,null,null,"b8",null,null,null,null],[null,null,null,"b3",null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","30"],map:[["b2","b2",null,null,null,null,"b1","b1"],["b4","b1",null,null,null,"b3","b6"],["b8","b4",null,null,null,null,"b6","b3"],["b8",null,null,null,null,null,"b3"],["b4","b1",null,null,null,null,"b2","b6"],["b4",null,null,null,null,null,"b6"],["b2","b4",null,null,null,null,"b6","b1"],["b2","b1",null,null,null,"b2","b1"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["20","38"],map:[[null,"b7",null,"b4",null,"b4",null,"b7"],["b4","b7",null,"b7","b4",null,"b4"],["b4",null,"b4",null,"b7",null,"b7",null],["b7","b4",null,"b4","b7",null,"b7"],[null,"b7",null,"b7",null,"b7",null,"b7"],["b4","b7",null,"b7","b4",null,"b4"],["b4",null,"b4",null,"b7",null,"b4",null],["b7","b7",null,"b4","b4",null,"b7"],[null,"b7",null,"b4",null,"b4",null,"b4"],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["12","25"],map:[[null,null,null,"b3","b3",null,null,null],[null,null,"b3","b3","b3",null,null],[null,null,null,"b1","b1",null,null,null],[null,null,"b4",null,"b4",null,null],[null,"b3",null,"b1","b1",null,"b3",null],[null,"b4","b3","b1","b3","b4",null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["13","26"],map:[[null,null,null,null,"b8",null,null,null],[null,null,null,"b3","b8",null,null],[null,"b4","b4","b3","b4","b6","b3",null],["b3",null,null,"b3","b6",null,"b4"],["b4",null,null,"b4",null,"b4","b3",null],["b3",null,"b6",null,null,null,null],[null,"b4","b3",null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["22","35"],map:[[null,"b3","b6","b6","b6","b6","b3",null],[null,null,"b3",null,"b3",null,null],[null,null,"b3","b8","b8","b3",null,null],[null,null,null,"b6",null,null,null],[null,null,null,"b8","b8",null,null,null],[null,null,"b6","b8","b6",null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["12","25"],map:[[null,null,"b8",null,null,null,null,null],[null,"b3","b8",null,null,null,"b1"],[null,null,"b1","b3",null,"b1","b3","b8"],[null,null,"b6","b1","b1",null,"b1"],[null,null,null,null,"b1","b6","b1",null],[null,null,null,"b6",null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["12","25"],map:[[null,null,null,"b8","b8",null,null,null],["b8","b3",null,"b8",null,"b3","b8"],[null,"b6",null,"b6","b6",null,"b6",null],[null,"b8","b8",null,"b8","b8",null],[null,null,null,"b3","b3",null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["12","25"],map:[[null,null,null,"b7","b7",null,null,null],[null,"b6","b6","b4","b6","b6",null],["b4",null,"b6",null,null,"b6",null,"b4"],["b6","b7","b6",null,"b6","b7","b6"],["b1","b1",null,null,null,null,"b1","b1"],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["12","25"],map:[[null,null,null,"b7","b7",null,null,null],["b7",null,null,"b8",null,null,"b7"],[null,"b6","b8","b8","b8","b8","b6",null],["b8","b1",null,"b7",null,"b1","b8"],[null,"b1",null,"b6","b6",null,"b1",null],["b6",null,null,null,null,null,"b6"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["10","20"],map:[[null,null,null,"b8","b8",null,null,null],["b7","b1","b8",null,"b8","b1","b7"],[null,"b4","b8",null,null,"b8","b4",null],["b1",null,null,null,null,null,"b1"],["b8","b7","b8","b1","b1","b8","b7","b8"],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["10","20"],map:[[null,null,null,null,null,"b3","b3",null],[null,null,null,null,null,null,"b3"],[null,null,null,"b4","b7",null,"b7",null],["b2","b8","b7",null,"b4","b2",null],["b2","b3","b2","b4","b7",null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["10","20"],map:[[null,"b3","b3","b7","b7","b3","b3",null],["b6","b7","b3","b3","b3","b7","b6"],[null,"b6",null,"b3","b3",null,"b6",null],[null,null,"b3","b8","b3",null,null],[null,null,null,"b8","b8",null,null,null],[null,null,"b8","b3","b8",null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["12","20"],map:[[null,null,null,"b8","b8",null,null,null],[null,"b1",null,"b8",null,"b1",null],[null,null,"b1","b1","b1","b1",null,null],[null,"b1",null,"b6",null,"b1",null],[null,"b1","b8",null,null,"b8","b1",null],["b6","b8",null,null,null,"b8","b6"],["b8","b6",null,null,null,null,"b6","b8"],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","25"],map:[[null,"b7","b7",null,null,"b7","b7",null],["b8",null,"b3","b1","b3",null,"b8"],["b8",null,null,"b3","b3",null,null,"b8"],["b1",null,null,null,null,null,"b1"],[null,"b1",null,null,null,null,"b1",null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["20","39"],map:[[null,null,"b8",null,null,"b8",null,null],[null,"b4",null,null,null,"b4",null],[null,null,"b3","b8","b8","b3",null,null],[null,null,"b4",null,"b4",null,null],[null,null,"b4","b3","b3","b4",null,null],[null,null,"b6",null,"b6",null,null],[null,null,"b3","b3","b3","b3",null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["19","35"],map:[[null,null,null,"b1","b1",null,null,null],[null,"b8","b1","b4","b1","b8",null],["b1",null,"b4","b8","b8","b4",null,"b1"],["b8","b4","b8",null,"b8","b4","b8"],[null,"b4",null,"b8","b8",null,"b4",null],[null,null,"b1","b4","b1",null,null],[null,null,"b4","b1","b1","b4",null,null],[null,null,"b8","b8","b8",null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["18","36"],map:[["b2",null,null,"b3","b3",null,null,"b2"],["b2","b2","b4","b3","b4","b2","b2"],[null,"b4",null,"b2","b2",null,"b4",null],[null,null,"b4",null,"b4",null,null],[null,null,"b2",null,null,"b2",null,null],[null,null,"b4","b4","b4",null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["23","40"],map:[["b4",null,null,null,null,null,null,"b4"],["b4",null,"b7","b7","b7",null,"b4"],[null,"b4","b7","b3","b3","b7","b4",null],["b8","b7","b3",null,"b3","b7","b8"],["b8","b7","b3",null,null,"b3","b7","b8"],["b8","b7","b3",null,"b3","b7","b8"],["b3","b3","b3","b6","b6","b3","b3","b3"],["b8","b1","b8","b7","b8","b1","b8"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["35","60"],map:[[null,"b3","b3",null,"b3","b3","b3",null],["b3","b7","b1","b6","b8","b1","b3"],["b4","b3","b3","b3",null,"b3","b3","b4"],["b2","b4","b2","b4","b2","b4","b2"],["b4","b3","b3",null,"b3","b3","b3","b4"],["b3","b1","b8","b6","b1","b2","b3"],["b7","b3","b3","b3",null,"b3","b3","b7"],["b4","b4","b7","b7","b7","b4","b4"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","30"],map:[[null,"b8","b1",null,null,null,null,null],["b3","b6","b3",null,null,null,null],[null,"b1","b8",null,null,null,null,null],[null,null,"b1","b3",null,null,null],[null,null,"b8","b6","b8",null,null,null],[null,null,"b3","b1",null,null,null],[null,null,null,null,"b3","b8",null,null],[null,null,null,"b1","b8","b1",null],[null,null,null,null,"b8","b3",null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["18","30"],map:[[null,null,null,"b7","b7",null,null,null],["b8","b6","b3","b1","b3","b6","b8"],[null,null,null,"b1","b1",null,null,null],[null,null,"b3",null,"b3",null,null],[null,null,"b3",null,null,"b3",null,null],[null,"b3","b6",null,"b6","b3",null],[null,null,"b6",null,null,"b6",null,null],[null,null,"b3","b6","b3",null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["10","25"],map:[[null,null,null,"b4","b4",null,null,null],["b4","b8","b8",null,"b8","b8","b4"],["b8",null,null,null,null,null,null,"b8"],["b8",null,null,null,null,null,"b8"],["b8","b1","b1",null,null,"b1","b1","b8"],[null,null,"b4",null,"b4",null,null],[null,null,"b3","b3","b3","b3",null,null],[null,"b4","b8",null,"b8","b4",null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","35"],map:[[null,null,null,null,"b6","b6",null,null],["b2",null,"b8","b6",null,null,"b8"],[null,"b6",null,null,"b6","b6","b7",null],["b6","b2","b8",null,"b2",null,null],[null,null,"b2",null,"b2",null,"b4","b8"],[null,"b4","b2",null,"b7","b2","b8"],[null,"b4","b6","b8","b7",null,null,"b2"],[null,"b2","b7",null,null,null,"b8"],[null,null,"b6",null,null,null,null,null],[null,null,"b8",null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["19","32"],map:[[null,null,null,"b7","b2","b7","b2",null],[null,null,null,"b7","b2","b7","b3"],[null,null,"b4",null,"b7",null,null,null],[null,"b3","b2","b2",null,"b3","b4"],[null,null,"b4","b3",null,"b2",null,"b7"],[null,"b2",null,"b3","b7",null,null],[null,null,null,null,"b2","b7",null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["16","35"],map:[[null,"b3",null,null,null,null,null,null],["b2","b2",null,null,null,null,null],["b7","b3","b7",null,null,null,null,null],[null,null,"b6",null,null,null,null],[null,null,null,"b8",null,null,null,null],[null,null,null,"b3",null,null,null],[null,null,null,"b4","b8","b3","b7",null],[null,null,null,"b8","b3","b2","b3"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["15","32"],map:[[null,null,null,null,"b6",null,null,null],[null,"b8",null,null,"b3","b2","b3"],[null,"b3","b2",null,"b2","b3","b6","b3"],["b6",null,"b6","b6",null,null,null],["b8",null,"b3","b8","b2",null,null,null],["b2",null,"b8",null,"b6","b2","b2"],["b2",null,"b6",null,null,"b2",null,"b8"],[null,"b6",null,null,null,"b2",null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["20","40"],map:[[null,null,null,"b6",null,null,null,null],[null,"b8",null,"b7","b6","b7",null],[null,"b6",null,"b7",null,null,"b8","b4"],["b6","b7","b7",null,null,"b8","b7"],["b4","b4","b6",null,null,"b7","b7","b8"],[null,null,null,"b7",null,"b8","b6"],[null,null,null,null,"b8","b8","b6",null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]},{star:["20","40"],map:[[null,null,"b3","b1","b3","b3",null,null],[null,"b3","b3",null,null,"b3","b7"],[null,null,null,null,"b7","b4",null,null],["b3","b1",null,null,null,"b4","b4"],["b7",null,null,null,"b7","b7",null,"b7"],["b3","b1",null,null,"b4",null,null],[null,"b3",null,null,"b3","b4",null,null],["b7",null,"b1",null,null,"b3","b1"],[null,"b4","b4","b3","b1","b1",null,"b1"],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]]}];var Global=Global||(window.Global={});Global.imgManifest=[{name:"b1",src:"bubbles/bubble_1.png"},{name:"b2",src:"bubbles/bubble_2.png"},{name:"b3",src:"bubbles/bubble_3.png"},{name:"b4",src:"bubbles/bubble_4.png"},{name:"b5",src:"bubbles/bubble_5.png"},{name:"b6",src:"bubbles/bubble_6.png"},{name:"b7",src:"bubbles/bubble_7.png"},{name:"b8",src:"bubbles/bubble_8.png"},{src:"page-room.png"},{src:"page-lvlist.png"},{src:"page-idx.png"},{src:"pic.png"},{src:"bg-list.png"},{src:"bg-list-d.png"},{src:"star.png"},{src:"star-b.png"},{src:"next.png"},{src:"prev.png"},{name:"compressor",src:"compressor.png"},{name:"btn-pause",src:"btn-pause.png"},{name:"cannon",src:"cannon.png"},{name:"bomb",src:"bubbles/bomb.png"}],Global.imgSource={};var Bubble=function(e){return this.data=_.extend({},e),this.map=this.data.map,this.data.posInfo=this.posInfo,this.hitBubbles=[],this.throwFix=0,this.init()};Bubble.prototype={init:function(){var e=Global.imgSource[this.get("type")],t=new createjs.Bitmap(e);return t.x=this.get("x"),t.y=this.get("y"),t.width=this.get("width"),t.height=this.get("height"),t.name=this.data.id=this.get("type")+"_"+t.id,this.el=t,this},checkHit:function(e){var t=this.el,n=this.get("dx"),r=this.get("dy"),i=e.params?e.params[0].delta/10:1,s=this,o=s.get("parent").compressorOffset;t.y+=r*i,t.x+=n*i,t.y<=o&&(t.y=o,this.stop()),t.x>=t.parent.width-t.width?(n*=-1,t.x=t.parent.width-t.width):t.x<=0&&(n*=-1,t.x=0),this.set("dx",n),_.each(this.get("bubbleList"),function(e){if(e.el.id!=s.el.id&&!s._stop){var t=Math.sqrt(Math.pow(s.el.x-e.el.x,2)+Math.pow(s.el.y-e.el.y,2));if(s.get("width")-t>s.throwFix)return void s.stop()}})},bomb:function(e){var t=this;if(_.each(this.hitBubbles,function(e){if(!_.isString(e)){{var n;_.find(e.hitBubbles,function(e,r){return _.isString(e)||e.get("id")!=t.get("id")?void 0:(n=r,!0)})}e.hitBubbles.splice(n,1)}}),this.map[this.posInfo.yIdx][this.posInfo.xIdx]=null,"falldown"==e){var n=this.el.y,r=75*Math.random()+30;createjs.Tween.get(this.el).to({y:n+r,opacity:.2},200).call(function(){t.el.parent.removeChild(t.el)})}else this.bombAnimate()},bombAnimate:function(){var e=new createjs.Sprite(this.get("parent").spriteSheet,"bomb"),t=this.el.parent,n=this.el;t.removeChild(n),e.x=this.el.x-38,e.y=this.el.y-38,t.addChild(e),e.on("animationend",function(){this.stop(),t.removeChild(e)}),e.play("bomb")},fallDown:function(){this.bomb("falldown")},shoot:function(e,t,n){console.log("发射==>",this.get("id"));var r=this,i=this.el.parent.x+this.el.x,s=this.el.parent.y+this.el.y,o=this.get("v"),u=this.get("width")/2+i-e,a=t-s-this.get("width")/2,f=Math.atan(a/u),l=o*Math.cos(f)*(0>f?-1:1),c=-1*o*Math.abs(Math.sin(f));this.set("dx",l),this.set("dy",c),this.onStopFn=n,this.el.on("tick",function(e){r._stop||r.checkHit.call(r,e)})},stop:function(){console.log("stop---",this.get("id")),this._stop=!0;var e=this,t=this.el.x,n=this.el.y-this.get("parent").compressorOffset,r=this.checkPos(t,n,this.get("width"));this.map[r.yIdx][r.xIdx]=this,this.checkSiblings(r),e.posInfo=r,_.each(e.hitBubbles,function(e){_.isString(e)||e.shake()}),createjs.Tween.get(this.el).to({x:r.x,y:r.y+e.get("parent").compressorOffset},50).wait(150).call(function(){e.onStopFn&&e.onStopFn(e)})},checkSiblings:function(e){e=e||this.posInfo;var t,n,r,i,s,o;t=this.map[e.yIdx][e.xIdx-1],t&&(-1==_.indexOf(t.hitBubbles,this)&&t.hitBubbles.push(this),-1==_.indexOf(this.hitBubbles,t)&&this.hitBubbles.push(t)),n=this.map[e.yIdx][e.xIdx+1],n&&(-1==_.indexOf(n.hitBubbles,this)&&n.hitBubbles.push(this),-1==_.indexOf(this.hitBubbles,n)&&this.hitBubbles.push(n)),e.yIdx?(r=e.yIdx%2>0?this.map[e.yIdx-1][e.xIdx]:this.map[e.yIdx-1][e.xIdx-1],r&&(-1==_.indexOf(this.hitBubbles,r)&&this.hitBubbles.push(r),-1==_.indexOf(r.hitBubbles,this)&&r.hitBubbles.push(this)),i=e.yIdx%2>0?this.map[e.yIdx-1][e.xIdx+1]:this.map[e.yIdx-1][e.xIdx],i&&(-1==_.indexOf(this.hitBubbles,i)&&this.hitBubbles.push(i),-1==_.indexOf(i.hitBubbles,this)&&i.hitBubbles.push(this))):this.hitBubbles.push("top"),this.map[e.yIdx+1]&&(s=e.yIdx%2>0?this.map[e.yIdx+1][e.xIdx]:this.map[e.yIdx+1][e.xIdx-1],s&&(-1==_.indexOf(this.hitBubbles,s)&&this.hitBubbles.push(s),-1==_.indexOf(s.hitBubbles,this)&&s.hitBubbles.push(this)),o=e.yIdx%2>0?this.map[e.yIdx+1][e.xIdx+1]:this.map[e.yIdx+1][e.xIdx],o&&(-1==_.indexOf(this.hitBubbles,o)&&this.hitBubbles.push(o),-1==_.indexOf(o.hitBubbles,this)&&o.hitBubbles.push(this)))},checkPos:function(e,t,n){var r=Math.round(t/Math.sqrt(3)/n*2),i=0;r%2>0&&(e-=n/2,i=n/2);var s=Math.round(e/n);return r%2&&(s=s>6?6:s),{x:s*n+i,y:r*Math.sqrt(3)*n/2,xIdx:s,yIdx:r}},shake:function(){var e=this.el.y;createjs.Tween.get(this.el).to({y:e-10},70).to({y:e},70)},get:function(e){return this.data[e]},set:function(e,t){this.data[e]=t}};var Game=function(e,t){this.parent=t,this.data=_.extend({realWidth:640,realHeight:960},e),this.el={room:$("#room"),infoPage:$("#info"),levelList:$("#levelList"),resume:$(".resume"),restart:$(".restart"),back:$(".back"),nextLv:$(".nextLv")},this.status=!1,this.bubbleW=64,this.bubbleH=64,this.bubbleV=25,this.bubbleList=[],this.compressorOffset=0,this.compressorV=15,this.compressorIdx=0,this.compressorD=10,this.gameTime=0,this.ball_cols=13,this.bubbleAnim=!1,this.stoneEnable=!1,this.stoneOdds=.1,this.stone_max=5,this.stone_cur=0,this._pause=!1,this.bubbleToDisappear=[],this.init()};Game.prototype={init:function(){this.inited||(this.inited=!0,console.log("关卡==>",this.data.level),$("#room").append('<canvas id="stage" width="640" height="960"></canvas>'),this.el.canvas=$("#stage"),this.stage=new createjs.Stage("stage"),createjs.Touch.enable(this.stage,!0),this.el.canvas.css({width:this.data.pageW,height:this.data.pageH}))},createEls:function(){console.log("create el"),this.bubbleContainer=new createjs.Container,this.bubbleContainer.x=64,this.bubbleContainer.y=100,this.bubbleContainer.width=512,this.bubbleContainer.height=740,this.stage.addChild(this.bubbleContainer),this.TIMEtxt=new createjs.Text("0","28px Arial","#FB8A3B"),this.TIMEtxt.x=67,this.TIMEtxt.y=18,this.pauseBtn=new createjs.Bitmap(Global.imgSource["btn-pause"]),this.pauseBtn.x=this.stage.canvas.width-100,this.pauseBtn.y=0,this.pauseBtn.cursor="pointer",this.pauseBtn.width=72,this.pauseBtn.height=70;var e=new Image;e.src=Global.imgSource.bomb,this.spriteSheet=new createjs.SpriteSheet({images:[e],frames:{width:140,height:140},animations:{bomb:[0,11]}}),this.compressor=new createjs.Bitmap(Global.imgSource.compressor),this.compressor.x=2,this.compressor.y=-40,this.compressor.width=502,this.compressor.height=40,this.bubbleContainer.addChild(this.compressor),this.stage.addChild(this.TIMEtxt,this.pauseBtn),this.initEvent()},initEvent:function(){var e=this;this.pauseBtn.on("mousedown",function(){e.pause.call(e)}),this.e_inited||(this.e_inited=!0,this.stage.on("stagemouseup",function(t){e.bubbleAnim||e._pause||(e.bubbleAnim=!0,e.bubbleList.push(e.bubble1),e.bubble1.shoot(t.stageX,t.stageY,function(t){"stone"!=t.get("type")?e.checkDisappear.call(e,t):e.checkGameover()}),e.drawBubble.call(e,1))}),this.el.resume.on("click",function(){e.resume.call(e);hide233FunRecommend()}),this.el.restart.on("click",function(){hide233FunRecommend();play68_submitScore(myGameLevel)}),this.el.back.on("click",function(){e.back.call(e);hide233FunRecommend()}),this.el.nextLv.on("click",function(){e.nextLv.call(e);hide233FunRecommend()}))},start:function(){console.log("game start!!!"),this._pause=!1,this.el.levelList.hide(),this.el.room.show(),this.status=!0;var e=this;this.el.room.show(),this.createEls(),createjs.Ticker.setPaused(!1),createjs.Ticker.hasEventListener("tick")||(createjs.Ticker.setFPS(60),createjs.Ticker.on("tick",function(){e._pause||e.stage.update()})),this.initMap(),this.drawBubble(2),this.drawBubble(1),this.startTimer()},drawBubble:function(e){if(2===e){this.stoneEnable&&this.stone_cur<this.stone_max?(e=Math.random()<this.stoneOdds?"stone":_.sample(this.bubbleTypeList),"stone"==e&&this.stone_cur++):e=_.sample(this.bubbleTypeList);var t=new Bubble({x:44,y:this.bubbleContainer.height-10,width:this.bubbleW,height:this.bubbleH,v:this.bubbleV,parent:this,bubbleList:this.bubbleList,type:e,map:this.map});this.bubbleContainer.addChild(t.el),this.bubble2=t}else{this.bubble2||this.drawBubble(2);var n=this,r=this.bubbleContainer.width/2-this.bubbleW/2,i=this.bubbleContainer.height-this.bubbleH/2;this.bubble1=this.bubble2,createjs.Tween.get(this.bubble1.el).to({x:r,y:i},150,createjs.Ease.backOut).call(function(){n.drawBubble(2)})}},initMap:function(){console.log("===>init map");var e=this;this.levelData=_.clone(Global.lvList[this.data.level]),this.map=[[],[],[],[],[],[],[],[],[],[],[],[],[]],this.bubbleTypeList=[],_.each(this.levelData.map,function(t,n){_.each(t,function(t,r){if(t){var i=r*e.bubbleW+(n%2?e.bubbleW/2:0),s=n*e.bubbleW*Math.sqrt(3)/2,o=new Bubble({x:i,y:s,width:e.bubbleW,height:e.bubbleH,v:e.bubbleV,parent:e,bubbleList:e.bubbleList,type:t,map:e.map});o.posInfo={x:i,y:s,xIdx:r,yIdx:n},"stone"!=t&&e.bubbleTypeList.push(t),e.bubbleContainer.addChild(o.el),e.map[n][r]=o,e.bubbleList.push(o)}})}),_.each(e.bubbleList,function(e){e.checkSiblings()}),console.log("绘制地图",this.bubbleContainer,this.stage)},showFPS:function(){var e=createjs.Ticker.getMeasuredFPS().toString().substring(0,4);this.FPStxt.text="FPS : "+e},checkDisappear:function(e){this.findBro(e),this.bubbleToDisappear.length>2&&(this.disappearBubbles(),this.checkFallDown()),this.bubbleToDisappear.length=0,this.updateBubbleTypeList(),this.checkGameover()},findBro:function(e){var t=this;_.each(e.hitBubbles,function(n){_.isString(n)||-1!=_.indexOf(t.bubbleToDisappear,n.get("id"))||n.get("type")!=e.get("type")||(t.bubbleToDisappear.push(n.get("id")),t.findBro.call(t,n))})},disappearBubbles:function(){console.log("--> disappear bubbles",this.bubbleToDisappear);var e=this;_.each(this.bubbleToDisappear,function(t){var n,r=_.find(e.bubbleList,function(e,r){return e.get("id")==t?(n=r,!0):void 0});r.bomb(),e.removeBubbleFromList.call(e,n)})},removeBubbleFromList:function(e){this.bubbleList.splice(e,1)},checkFallDown:function(){var e=this,t=[],n=function(e){e.set("hasLinks",1),_.each(e.hitBubbles,function(e){_.isString(e)||e.get("hasLinks")||n(e)})};_.each(this.map,function(e){_.each(e,function(e){e&&!e.get("hasLinks")&&0===e.posInfo.yIdx&&(e.set("hasLinks",1),_.each(e.hitBubbles,function(e){_.isString(e)||e.get("hasLinks")||n(e)}))})}),_.each(this.bubbleList,function(e){e.get("hasLinks")?e.set("hasLinks",!1):(e.fallDown(),t.push(e))}),_.each(t,function(t){var n=_.indexOf(e.bubbleList,t);e.removeBubbleFromList.call(e,n)}),console.log("--> left",this.bubbleList.length)},startTimer:function(){var e=this,t=this.TIMEtxt;this.gameTimer=setInterval(function(){e.gameTime++,t.text=e.gameTime,e.moveCompressor()},1e3)},showInfo:function(e,t){this.el.infoPage.fadeIn(10);var n=$("#"+e+"Info");if(n.addClass("show"),"gameWin"==e){var r="";n.find(".nextLv")[t.fn](),n.find(".time").html(Util.formateTime(this.gameTime)),_(3).times(function(e){r+=e+1<=t.lvInfo.star?"<i class='star'></i>":"<i></i>"}),n.find(".star-wrap").html(r)}},hideInfo:function(){this.el.infoPage.find(".dialog").removeClass("show"),this.el.infoPage.fadeOut(200)},resume:function(){console.log("game resume"),this.hideInfo("resume"),this._pause=!1,this.startTimer(),createjs.Ticker.setPaused(!1)},reset:function(){console.log("game reset"),this.stone_cur=0,this._pause=!0,this.hideInfo("resume"),clearInterval(this.gameTimer),this.stage.removeAllChildren(),this.bubbleList.length=0,this.levelData=null,this.bubbleTypeList.length=0,this.map.length=0,this.bubbleAnim=!1,this.gameTime=0,this.compressorOffset=0,this.compressorIdx=0},back:function(){console.log("game back"),this.status=!1,this.reset(),this.parent.resetGame()},nextLv:function(){console.warn("next level",this.data.level);var e=this.data.level+1;this.data.level=e,this.reset(),this.start()},pause:function(){console.log("game pause"),this._pause=!0,clearInterval(this.gameTimer),this.showInfo("pause")},stop:function(){console.log("game stop"),this._pause=!0,clearInterval(this.gameTimer)},resize:function(e){this.status&&this.pause(),this.el.canvas.width(e.w),this.el.canvas.height(e.h),this.data.pageW=e.w,this.data.pageH=e.h},updateBubbleTypeList:function(){var e=this;this.bubbleTypeList.length=0,_.each(this.bubbleList,function(t){"stone"!=t.get("type")&&e.bubbleTypeList.push(t.get("type"))})},checkGameover:function(){if(console.log("check game over",this.bubbleContainer),this.moveCompressor(!0),0===this.bubbleList.length){var e=this;return void setTimeout(function(){e.gameWin.call(e);show233FunRecommend();},500)}this.bubbleAnim=!1},moveCompressor:function(e){if(!this.bubbleAnim||e){var t=this,n=Math.floor(this.gameTime/this.compressorD),r=!1;n>this.compressorIdx&&(this.compressorOffset=this.compressorV*n,this.compressor.y=this.compressorOffset-this.compressor.height,this.compressorIdx=n,_.each(this.bubbleList,function(e){e.posInfo&&(e.el.y=e.posInfo.y+t.compressorOffset)})),_.each(this.bubbleList,function(e){if(e.posInfo){var n=Math.round(e.el.y/Math.sqrt(3)/t.bubbleH*2);n>=t.ball_cols-1&&(r=!0)}}),r&&t.gameLost()}},gameWin:function(){this.stop();var e="show",t=localStorage.getItem("lvData");t=JSON.parse(t);var n=parseInt(localStorage.getItem("lv")),r=3-_.sortedIndex(this.levelData.star,this.gameTime),i=t[this.data.level];myGameLevel=this.data.level+1;i=i||{},(!i.time||i.time>this.gameTime)&&(i.time=this.gameTime),(!i.star||i.star<r)&&(i.star=r),t[this.data.level]=i,localStorage.setItem("lvData",JSON.stringify(t)),Global.lvList[this.data.level+1]&&n<this.data.level+1&&localStorage.setItem("lv",this.data.level+1),Global.lvList[this.data.level+1]||(console.log("没有下一关了"),e="hide"),this.showInfo("gameWin",{lvInfo:i,fn:e})},gameLost:function(){this.stop(),this.showInfo("gameLost");/*updateShare(myGameLevel);Play68.setRankingScoreDesc(myGameLevel);*/}},function(){var e="0.1.6",t=function(){this.el={grid:$("#grid"),loading:$("#loading"),levelList:$("#levelList"),index:$("#index"),room:$("#room"),loadingBar:$("#loadingBar"),levelListContainer:$("#levelList ul"),containerWrap:$("#levelList .wrap"),start:$("#start"),goToIndex:$("#goToIndex"),prev:$("#prev"),next:$("#next"),handler_txt:$("#handler .txt"),handler_prev:$("#handler .icon-prev"),handler_next:$("#handler .icon-next")},this.tpl={lvItem:$("#tpl_lvItem").html()},this.data={},this.loading(),this.prefix=Util.browerKernel()};t.prototype={loading:function(){this.el.grid.show(),this.resize();var t=localStorage.getItem("_ver");t!=e&&(localStorage.clear(),localStorage.setItem("_ver",e));var n=new createjs.LoadQueue(!0,"assets/img/");n.on("progress",_.bind(this.handleProgress,this)),n.on("fileload",_.bind(this.handleFileLoad,this)),n.loadManifest(Global.imgManifest)},handleProgress:function(e){var t=(100*e.progress).toString().substring(0,4)+"%";if(this.el.loadingBar.width(t),1==e.progress){var n=this;setTimeout(function(){n.init.call(n)},500)}},handleFileLoad:function(e){e.item.name&&(Global.imgSource[e.item.name]=e.item.src)},init:function(){this.inited||($("body").attr("class","index"),$("#win-loading").remove(),this.inited=!0,this.el.loading.hide(),this.el.index.show(),this.updateHandler(),this.updateLevelList(),this.initEvent())},updateLevelList:function(){var e=localStorage.getItem("lvData"),t=parseInt(localStorage.getItem("lv"))||0,n=this;e=e?JSON.parse(e):[{time:0,star:0}];var r="";_.each(Global.lvList,function(i,s){var o=t>=s,u=e[s]||{star:0,time:0},f={className:o?"unlock":"lock",lv:s,idx:s+1,star:o?u.star:0,time:o?Util.formateTime(u.time):""},l=_.template(n.tpl.lvItem,f);1>s%16&&(l="<li>"+l),s%16==15&&(l+="</li>"),r+=l}),this.el.levelListContainer.empty().html(r),this.el.levelListContainer.find("li").width(this.data.pageW),this.el.handler_txt.html(t+1+"/"+Global.lvList.length),this.el.containerWrap.data("pageIdx",Math.floor(t/16)),localStorage.setItem("lv",t),localStorage.setItem("lvData",JSON.stringify(e))},updateHandler:function(){var e=Math.ceil(Global.lvList.length/16)*this.data.pageW;this.el.levelListContainer.width(e),this.el.levelListContainer.find("li").width(this.data.pageW)},scroll:function(){var e=(parseInt(localStorage.getItem("lv"))||0,this.el.containerWrap.data("pageIdx")),t=this.data.pageW;this.el.containerWrap.data("pageIdx",e).animate({scrollLeft:e*t},200);var n=Math.floor(Global.lvList.length/16);this.el.handler_prev.toggle(!!e),this.el.handler_next.toggle(n>e)},resize:function(){var e,t,n=window.innerHeight,r=window.innerWidth,i=1.5;return r*i>n?(t=n,e=n/i):(e=r,t=e*i),this.data.pageW=e,this.data.pageH=t,this.el.grid.width(e),this.el.grid.height(t),{w:e,h:t}},initEvent:function(){var e=this,t=fingerJS.touch?"touchend":"click";this.el.start.on(t,function(){e.el.index.hide(),e.el.levelList.show(),e.scroll.call(e)}),this.el.levelList.on(t,".lv-item",function(){var t=$(this).data("lv"),n=$(this).hasClass("lock");n||e.gameStart.call(e,t)}),this.el.goToIndex.on(t,function(){e.el.levelList.hide(),e.el.index.show()}),$(window).resize(function(){var t=e.resize.call(e);e.game&&e.game.resize(t),e.updateHandler.call(e),e.scroll.call(e)}),$(window).on("orientationchange",function(){var t=e.resize.call(e);e.game&&e.game.resize(t),e.updateHandler.call(e),e.scroll.call(e)}),document.addEventListener(e.prefix+"visibilitychange",function(){var t=document[e.prefix+"VisibilityState"];"hidden"==t&&e.game&&e.game.status&&e.game.pause()});document.querySelector("#levelList ul");fingerJS.on("#listWrap","swipe",function(t){var n,r=t.type;"swipe-left"==r?(n=parseInt(e.el.containerWrap.data("pageIdx"))+1,pageMax=Math.floor(Global.lvList.length/16),n=n>pageMax?pageMax:n):"swipe-right"==r&&(n=parseInt(e.el.containerWrap.data("pageIdx"))-1,n=0>n?0:n),e.el.containerWrap.data("pageIdx",n),e.scroll.call(e,n)}),$("#weixinShare").on(t,function(){var e=str0+"秒";try{parent.__4399finishgame(e)}catch(t){}}),$("#share").on(t,function(){})},gameStart:function(e){var t={level:e,pageH:this.data.pageH,pageW:this.data.pageW};this.game?this.game.data.level=e:this.game=new Game(t,this),this.game.start()},resetGame:function(){this.updateLevelList(),this.el.room.hide(),this.el.levelList.show(),this.scroll(),$("body").attr("class","lvList")}},window.app=new t}()